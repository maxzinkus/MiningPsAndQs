#include <stdio.h>
#include <unistd.h>

#include "RSA.h"

   char *RSA_1 = "40551717335634282796188595809907574636047497578447239742728984932123966624413413502767149538720812803461325270023373882379621912810451972080538881907407663962222269155722813641736702957601282436859549047516678171448999396597860674018511185283001161464214443896828880085703268792922456861374890446256379858691";
   char *RSA_2 = "20206959438259854707096595471756105531930316075003167441731682706437219837341080908001111386293866032342626326848774263655678734593467631039894350313079615694852898024651578877719067806299113646594515472905349384536141736001255892484345636015474986800809610322697749058964984183679288924809293079735255754321";
   char *GCD = "7958371467617366824605775912960638834791855716610959117124052267528546374374593198071120059398734032490380767332883052662861580136473938906942059406675053";
   char *ciphertext = "21146360143304879584870745425454388339130123805805568677708774327812403952131165797204738467133149361047649013024046635077706337064012827612590921151908148059770846065742477880796909563967180928127867305091668302606535495924923769855539541035294698913180720693428844640760225771248139707088375991239007140103";

void main(int argc, char **argv) {
   pub_key pub;
   priv_key priv;
   mpz_t rec, ct, rsa1, rsa2; 

   mpz_inits(rec, ct, rsa1, rsa2, NULL);
   mpz_set_str(ct, ciphertext, 10);

   init_keypair(&pub, &priv);
   mpz_set_str(priv.p, GCD, 10);
   mpz_set_str(rsa1, RSA_1, 10);
   mpz_set_str(rsa2, RSA_2, 10);

   mpz_tdiv_q(priv.q, rsa1, priv.p);
   key_gen(&pub, &priv);
   decrypt(rec, &priv, ct);
   mpz_out_str(stdout, 16, rec);
   putchar('\n');
   putchar('\n');

   mpz_tdiv_q(priv.q, rsa2, priv.p);
   key_gen(&pub, &priv);
   decrypt(rec, &priv, ct);
   mpz_out_str(stdout, 16, rec);
   putchar('\n');
}
